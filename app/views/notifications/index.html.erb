<h1>Notifications</h1>

<ul id="notifications">
  <%= render @notifications %>
</ul>

<%= javascript_tag do %>
  $(function() {
    App.notifications = App.cable.subscriptions.create({
      channel: 'NotificationsChannel'
    }, {
      received: function(data) {
        $('#notifications').prepend('<%= j render data.notification %>');
        $('#unread-count').text(data.count);
      }
    });
  });
<% end %>
<%= render partial:'shared/heading', locals: { heading:'Notifications' } %>

<div id="notifications-container">
  <ul id="notifications-list">
    <% @notifications.each do |notification| %>
      <%= render 'notification', notification: notification %>
    <% end %>
  </ul>
  <button id="mark-all-as-read-button">Mark all as read</button>
</div>
